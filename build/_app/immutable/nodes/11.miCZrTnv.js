import{s as ce,u as P,d as g,v as x,i as K,b as m,x as _e,z as ge,l as N,m as he,g as w,c as B,e as C,o as ve,j as F,h as I,k as be,a as le,f as ie,t as oe}from"../chunks/zcCs4naO.js";import{S as $e,i as Ee,f as G,d as M,t as z,a as H,m as L,b as R,e as T}from"../chunks/CfCKwUYM.js";import{g as ye}from"../chunks/DFYyETJK.js";import{b as ae,t as Z}from"../chunks/Droe60yk.js";import{B as De}from"../chunks/Dx4fLEUM.js";import{I as J}from"../chunks/BOJ5ACe9.js";function re(n){let r,u;return{c(){r=I("div"),u=oe(n[5]),this.h()},l(t){r=B(t,"DIV",{class:!0});var s=C(r);u=ie(s,n[5]),s.forEach(g),this.h()},h(){N(r,"class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded")},m(t,s){K(t,r,s),m(r,u)},p(t,s){s&32&&le(u,t[5])},d(t){t&&g(r)}}}function we(n){let r=n[4]?"Регистрация...":"Зарегистрироваться",u;return{c(){u=oe(r)},l(t){u=ie(t,r)},m(t,s){K(t,u,s)},p(t,s){s&16&&r!==(r=t[4]?"Регистрация...":"Зарегистрироваться")&&le(u,r)},d(t){t&&g(u)}}}function Fe(n){let r,u,t,s,h=`<h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Регистрация</h2> <p class="mt-2 text-center text-sm text-gray-600">Или
				<a href="/login" class="font-medium text-primary-600 hover:text-primary-500">войдите</a></p>`,v,l,b,a,d,V,k,c,q,o,f,Q,U,$,W,X,j,y,O,Y,ee,i=n[5]&&re(n);function fe(e){n[8](e)}let ue={label:"Email",type:"email",required:!0,placeholder:"your@email.com"};n[0]!==void 0&&(ue.value=n[0]),d=new J({props:ue}),P.push(()=>G(d,"value",fe));function pe(e){n[9](e)}let te={label:"Пароль",type:"password",required:!0,placeholder:"Минимум 8 символов"};n[1]!==void 0&&(te.value=n[1]),c=new J({props:te}),P.push(()=>G(c,"value",pe));function me(e){n[10](e)}let ne={label:"Подтвердите пароль",type:"password",required:!0,placeholder:"••••••••"};n[2]!==void 0&&(ne.value=n[2]),f=new J({props:ne}),P.push(()=>G(f,"value",me));function de(e){n[11](e)}let se={label:"Название организации (необязательно)",type:"text",placeholder:"По умолчанию будет использован email"};return n[3]!==void 0&&(se.value=n[3]),$=new J({props:se}),P.push(()=>G($,"value",de)),y=new De({props:{type:"submit",variant:"primary",size:"lg",loading:n[4],class:"w-full",$$slots:{default:[we]},$$scope:{ctx:n}}}),{c(){r=F(),u=I("div"),t=I("div"),s=I("div"),s.innerHTML=h,v=F(),l=I("form"),i&&i.c(),b=F(),a=I("div"),T(d.$$.fragment),k=F(),T(c.$$.fragment),o=F(),T(f.$$.fragment),U=F(),T($.$$.fragment),X=F(),j=I("div"),T(y.$$.fragment),this.h()},l(e){he("svelte-p90xsi",document.head).forEach(g),r=w(e),u=B(e,"DIV",{class:!0});var A=C(u);t=B(A,"DIV",{class:!0});var D=C(t);s=B(D,"DIV",{"data-svelte-h":!0}),ve(s)!=="svelte-12wjtyn"&&(s.innerHTML=h),v=w(D),l=B(D,"FORM",{class:!0});var E=C(l);i&&i.l(E),b=w(E),a=B(E,"DIV",{class:!0});var _=C(a);R(d.$$.fragment,_),k=w(_),R(c.$$.fragment,_),o=w(_),R(f.$$.fragment,_),U=w(_),R($.$$.fragment,_),_.forEach(g),X=w(E),j=B(E,"DIV",{});var S=C(j);R(y.$$.fragment,S),S.forEach(g),E.forEach(g),D.forEach(g),A.forEach(g),this.h()},h(){document.title="Регистрация - Budget SaaS",N(a,"class","rounded-md shadow-sm space-y-4"),N(l,"class","mt-8 space-y-6"),N(t,"class","max-w-md w-full space-y-8"),N(u,"class","min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8")},m(e,p){K(e,r,p),K(e,u,p),m(u,t),m(t,s),m(t,v),m(t,l),i&&i.m(l,null),m(l,b),m(l,a),L(d,a,null),m(a,k),L(c,a,null),m(a,o),L(f,a,null),m(a,U),L($,a,null),m(l,X),m(l,j),L(y,j,null),O=!0,Y||(ee=_e(l,"submit",ge(n[6])),Y=!0)},p(e,[p]){e[5]?i?i.p(e,p):(i=re(e),i.c(),i.m(l,b)):i&&(i.d(1),i=null);const A={};!V&&p&1&&(V=!0,A.value=e[0],x(()=>V=!1)),d.$set(A);const D={};!q&&p&2&&(q=!0,D.value=e[1],x(()=>q=!1)),c.$set(D);const E={};!Q&&p&4&&(Q=!0,E.value=e[2],x(()=>Q=!1)),f.$set(E);const _={};!W&&p&8&&(W=!0,_.value=e[3],x(()=>W=!1)),$.$set(_);const S={};p&16&&(S.loading=e[4]),p&4112&&(S.$$scope={dirty:p,ctx:e}),y.$set(S)},i(e){O||(H(d.$$.fragment,e),H(c.$$.fragment,e),H(f.$$.fragment,e),H($.$$.fragment,e),H(y.$$.fragment,e),O=!0)},o(e){z(d.$$.fragment,e),z(c.$$.fragment,e),z(f.$$.fragment,e),z($.$$.fragment,e),z(y.$$.fragment,e),O=!1},d(e){e&&(g(r),g(u)),i&&i.d(),M(d),M(c),M(f),M($),M(y),Y=!1,ee()}}}function Be(n,r,u){let t;be(n,ae,o=>u(7,t=o));let s="",h="",v="",l="",b=!1,a="";async function d(o){if(o.preventDefault(),u(5,a=""),!s||!h||!v){u(5,a="Заполните все поля");return}if(h!==v){u(5,a="Пароли не совпадают");return}if(h.length<8){u(5,a="Пароль должен быть не менее 8 символов");return}u(4,b=!0);try{const f=await ae.register(s,h,l||void 0);u(4,b=!1),f.success?Z.success("Регистрация выполнена успешно"):(u(5,a=f.error||"Ошибка регистрации"),Z.error(a))}catch(f){u(4,b=!1),console.error("Register error:",f),u(5,a="Произошла ошибка при регистрации. Пожалуйста, попробуйте снова."),Z.error(a)}}function V(o){s=o,u(0,s)}function k(o){h=o,u(1,h)}function c(o){v=o,u(2,v)}function q(o){l=o,u(3,l)}return n.$$.update=()=>{n.$$.dirty&128&&t.isAuthenticated&&ye("/")},[s,h,v,l,b,a,d,t,V,k,c,q]}class je extends $e{constructor(r){super(),Ee(this,r,Be,Fe,ce,{})}}export{je as component};
