import{s as ae,u as N,d as c,v as Q,i as k,b as g,x as ne,l as x,m as re,g as B,c as y,e as L,o as oe,j as S,h as $,k as ie,a as Z,f as ee,t as te}from"../chunks/zcCs4naO.js";import{S as le,i as ce,f as U,d as M,t as j,a as H,m as T,b as z,e as O}from"../chunks/CfCKwUYM.js";import{g as fe}from"../chunks/S-CVlYvQ.js";import{b as W,t as P}from"../chunks/Droe60yk.js";import{B as de}from"../chunks/Dx4fLEUM.js";import{I as X}from"../chunks/BOJ5ACe9.js";function Y(a){let n,e;return{c(){n=$("div"),e=te(a[3]),this.h()},l(t){n=y(t,"DIV",{class:!0});var s=L(n);e=ee(s,a[3]),s.forEach(c),this.h()},h(){x(n,"class","bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded")},m(t,s){k(t,n,s),g(n,e)},p(t,s){s&8&&Z(e,t[3])},d(t){t&&c(n)}}}function pe(a){let n=a[2]?"Вход...":"Войти",e;return{c(){e=te(n)},l(t){e=ee(t,n)},m(t,s){k(t,e,s)},p(t,s){s&4&&n!==(n=t[2]?"Вход...":"Войти")&&Z(e,n)},d(t){t&&c(e)}}}function me(a){let n,e,t,s,h=`<h2 class="mt-6 text-center text-3xl font-extrabold text-gray-900">Вход в систему</h2> <p class="mt-2 text-center text-sm text-gray-600">Или
				<a href="/register" class="font-medium text-primary-600 hover:text-primary-500">зарегистрируйтесь</a></p>`,v,r,D,f,i,l,d,_,A,q,w,b,I,C,R,o=a[3]&&Y(a);function ue(u){a[6](u)}let G={label:"Email",type:"email",required:!0,placeholder:"your@email.com"};a[0]!==void 0&&(G.value=a[0]),i=new X({props:G}),N.push(()=>U(i,"value",ue));function se(u){a[7](u)}let J={label:"Пароль",type:"password",required:!0,placeholder:"••••••••"};return a[1]!==void 0&&(J.value=a[1]),_=new X({props:J}),N.push(()=>U(_,"value",se)),b=new de({props:{type:"submit",variant:"primary",size:"lg",loading:a[2],class:"w-full",$$slots:{default:[pe]},$$scope:{ctx:a}}}),{c(){n=S(),e=$("div"),t=$("div"),s=$("div"),s.innerHTML=h,v=S(),r=$("form"),o&&o.c(),D=S(),f=$("div"),O(i.$$.fragment),d=S(),O(_.$$.fragment),q=S(),w=$("div"),O(b.$$.fragment),this.h()},l(u){re("svelte-445ycb",document.head).forEach(c),n=B(u),e=y(u,"DIV",{class:!0});var F=L(e);t=y(F,"DIV",{class:!0});var E=L(t);s=y(E,"DIV",{"data-svelte-h":!0}),oe(s)!=="svelte-df685g"&&(s.innerHTML=h),v=B(E),r=y(E,"FORM",{class:!0});var m=L(r);o&&o.l(m),D=B(m),f=y(m,"DIV",{class:!0});var V=L(f);z(i.$$.fragment,V),d=B(V),z(_.$$.fragment,V),V.forEach(c),q=B(m),w=y(m,"DIV",{});var K=L(w);z(b.$$.fragment,K),K.forEach(c),m.forEach(c),E.forEach(c),F.forEach(c),this.h()},h(){document.title="Вход - Budget SaaS",x(f,"class","rounded-md shadow-sm -space-y-px"),x(r,"class","mt-8 space-y-6"),x(t,"class","max-w-md w-full space-y-8"),x(e,"class","min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8")},m(u,p){k(u,n,p),k(u,e,p),g(e,t),g(t,s),g(t,v),g(t,r),o&&o.m(r,null),g(r,D),g(r,f),T(i,f,null),g(f,d),T(_,f,null),g(r,q),g(r,w),T(b,w,null),I=!0,C||(R=ne(r,"submit",a[4]),C=!0)},p(u,[p]){u[3]?o?o.p(u,p):(o=Y(u),o.c(),o.m(r,D)):o&&(o.d(1),o=null);const F={};!l&&p&1&&(l=!0,F.value=u[0],Q(()=>l=!1)),i.$set(F);const E={};!A&&p&2&&(A=!0,E.value=u[1],Q(()=>A=!1)),_.$set(E);const m={};p&4&&(m.loading=u[2]),p&260&&(m.$$scope={dirty:p,ctx:u}),b.$set(m)},i(u){I||(H(i.$$.fragment,u),H(_.$$.fragment,u),H(b.$$.fragment,u),I=!0)},o(u){j(i.$$.fragment,u),j(_.$$.fragment,u),j(b.$$.fragment,u),I=!1},d(u){u&&(c(n),c(e)),o&&o.d(),M(i),M(_),M(b),C=!1,R()}}}function ge(a,n,e){let t;ie(a,W,l=>e(5,t=l));let s="",h="",v=!1,r="";async function D(l){if(l.preventDefault(),e(3,r=""),!s||!h){e(3,r="Заполните все поля");return}e(2,v=!0),console.log("[Login] Starting login process");try{const d=await W.login(s,h);console.log("[Login] Login result:",d),e(2,v=!1),d.success?(console.log("[Login] Login successful, showing toast"),P.success("Вход выполнен успешно"),console.log("[Login] Current auth state:",t.isAuthenticated)):(console.error("[Login] Login failed:",d.error),e(3,r=d.error||"Ошибка входа"),P.error(r))}catch(d){e(2,v=!1),console.error("[Login] Login exception:",d),e(3,r="Произошла ошибка при входе. Пожалуйста, попробуйте снова."),P.error(r)}}function f(l){s=l,e(0,s)}function i(l){h=l,e(1,h)}return a.$$.update=()=>{a.$$.dirty&32&&t.isAuthenticated&&fe("/")},[s,h,v,r,D,t,f,i]}class $e extends le{constructor(n){super(),ce(this,n,ge,me,ae,{})}}export{$e as component};
